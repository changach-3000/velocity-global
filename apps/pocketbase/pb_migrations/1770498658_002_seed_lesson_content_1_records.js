/// <reference path="../pb_data/types.d.ts" />
migrate((app) => {
  const collection = app.findCollectionByNameOrId("lesson_content");

  const record0 = new Record(collection);
    record0.set("lesson_id", "pbc_lesson_2");
    record0.set("content_body", "SECTION 1: Lessee Recognition and Measurement\n\nLessee Recognition:\n\nAt Lease Commencement:\n1. Recognize right-of-use asset\n2. Recognize lease liability\n3. Measure at present value of lease payments\n4. Example: $500K equipment = $500K ROU asset + $450K liability\n\nMeasurement:\n\nRight-of-Use Asset:\n- Measured at cost\n- Cost = Lease liability + Initial direct costs - Lease incentives\n- Example: $450K liability + $5K costs - $0 incentives = $455K ROU asset\n\nLease Liability:\n- Measured at present value of lease payments\n- Discount rate: Incremental borrowing rate (if implicit rate unknown)\n- Lease payments: Fixed + variable (linked to index) + residual guarantees\n- Example: PV of $10K/month \u00d7 60 months = $450K\n\nSECTION 2: Subsequent Measurement\n\nROU Asset Depreciation:\n\nDepreciation Method:\n- Straight-line depreciation over lease term\n- Example: $500K / 5 years = $100K/year\n\nDepreciation Calculation:\n- Annual depreciation = ROU asset / Lease term\n- Example: $500K / 5 = $100K/year\n\nAccumulated Depreciation:\n- Reduces carrying value of ROU asset\n- Example: Year 1 accumulated depreciation = $100K\n\nLease Liability Interest:\n\nInterest Calculation:\n- Interest = Lease liability \u00d7 Discount rate\n- Example: $450K \u00d7 5% = $22,500 Year 1 interest\n\nInterest Expense:\n- Recognized in profit or loss\n- Decreases over time as liability decreases\n- Example: Year 1 interest = $22,500, Year 2 = $20,000\n\nLease Payment Allocation:\n\nEach Lease Payment:\n- Principal portion: Reduces lease liability\n- Interest portion: Recognized as interest expense\n- Example: $10K payment = $7,500 principal + $2,500 interest\n\nSECTION 3: Lease Modifications\n\nWhat is a Lease Modification?\n- Change to lease terms or conditions\n- Requires remeasurement of liability and asset\n- Example: Extension of lease term, change in payment\n\nTypes of Modifications:\n\n1. Scope Changes:\n   - Addition or removal of equipment\n   - Example: Add 10 computers to existing lease\n\n2. Payment Changes:\n   - Change in lease payment amount\n   - Example: Increase payment from $10K to $11K/month\n\n3. Term Changes:\n   - Extension or shortening of lease term\n   - Example: Extend lease from 5 years to 7 years\n\n4. Residual Value Changes:\n   - Change in residual value guarantee\n   - Example: Increase residual guarantee from $50K to $75K\n\nModification Accounting:\n\nStep 1: Identify Modification:\n- Determine type of modification\n- Example: Lease term extension\n\nStep 2: Calculate New Lease Liability:\n- Identify new lease payments\n- Discount at appropriate rate\n- Example: New PV = $600,000\n\nStep 3: Adjust ROU Asset:\n- Adjust for change in liability\n- Adjust for any direct costs\n- Example: ROU asset increases by $50,000\n\nStep 4: Record Adjustment:\n- Debit/credit ROU asset and liability\n- Example: Debit ROU asset $50,000, Credit liability $50,000\n\nSECTION 4: Case Study - IFRS 16 Lessee Accounting\n\nCompany: LesseeAccounting Inc.\nSituation: Accounting for manufacturing equipment lease\n\nLease Details:\n- Equipment: Manufacturing equipment\n- Equipment cost: $500,000\n- Lease term: 5 years (60 months)\n- Monthly payment: $10,000\n- Residual value guarantee: $50,000\n- Incremental borrowing rate: 5% annual\n- Initial direct costs: $5,000\n\nLease Commencement:\n\nLease Liability Calculation:\n- Monthly payment: $10,000\n- Number of payments: 60\n- Monthly discount rate: 0.4167% (5% / 12)\n- PV of payments: $10,000 \u00d7 54.3 = $543,000\n- Residual guarantee: $50,000 \u00d7 (1.05)^-5 = $39,175\n- Total lease liability: $582,175\n\nROU Asset Calculation:\n- Lease liability: $582,175\n- Initial direct costs: $5,000\n- ROU asset: $587,175\n\nLease Commencement Entry:\n- Debit: ROU Asset $587,175\n- Credit: Lease Liability $582,175\n- Credit: Cash $5,000\n\nYear 1 Accounting:\n\nMonthly Lease Payment Entry:\n- Debit: Lease Liability $9,000\n- Debit: Interest Expense $1,964\n- Credit: Cash $10,000\n- Credit: ROU Asset $964\n\nMonthly Depreciation Entry:\n- Debit: Depreciation Expense $9,786\n- Credit: Accumulated Depreciation - ROU Asset $9,786\n\nYear 1 Summary:\n- Total lease payments: $120,000\n- Total interest expense: $23,568\n- Total depreciation: $117,432\n- Total lease expense: $141,000\n\nBalance Sheet (End of Year 1):\n- ROU Asset: $587,175 - $117,432 = $469,743\n- Lease Liability: $582,175 - $108,000 = $474,175");
  app.save(record0);
}, (app) => {
  // Rollback: record IDs not known, manual cleanup needed
})
