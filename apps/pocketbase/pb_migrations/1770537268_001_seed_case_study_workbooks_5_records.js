/// <reference path="../pb_data/types.d.ts" />
migrate((app) => {
  const collection = app.findCollectionByNameOrId("case_study_workbooks");

  const record0 = new Record(collection);
    record0.set("title", "Lease Accounting Fundamentals for Finance Professionals - Case Study Workbook");
    record0.set("lesson_id", "pbc_3963162141_lesson_1");
    record0.set("part_number", 1);
    record0.set("case_study_name", "TechCorp Manufacturing");
    record0.set("company_background", "Mid-size technology manufacturing company with $150M annual revenue implementing ASC 842 lease accounting for $25M equipment portfolio. Challenge: Properly classify and account for diverse lease portfolio including equipment, machinery, and facility leases under new accounting standards.");
    record0.set("workbook_sections", "1. Company Background and Current Situation\n2. Lease Portfolio Overview (equipment types, lease terms, values)\n3. ASC 842 Implementation Assessment\n4. ROU Asset and Lease Liability Calculation Worksheets (5 sample leases)\n5. Lease Classification Exercise (classify 10 leases as operating or finance)\n6. Lease Identification Practice (identify lease components in 5 contracts)\n7. Financial Statement Impact Analysis Worksheet\n8. Balance Sheet Presentation Template\n9. Income Statement Impact Calculation\n10. Cash Flow Statement Presentation\n11. Practical Exercise 1: Calculate ROU asset and liability for $10M lease (5-year term, 5% discount rate)\n12. Practical Exercise 2: Classify 5 leases and explain classification rationale\n13. Practical Exercise 3: Prepare balance sheet and income statement impact analysis\n14. Discussion Questions (8 questions covering lease identification, classification, accounting treatment, financial statement presentation, and implementation challenges)\n15. Solutions and Detailed Answers with step-by-step calculations and explanations");
    record0.set("includes_worksheets", true);
    record0.set("includes_templates", true);
    record0.set("includes_solutions", true);
    record0.set("content_summary", "Comprehensive case study workbook for lease accounting fundamentals. Includes detailed worksheets for ROU asset and liability calculations, lease classification exercises, financial statement impact analysis, and practical exercises with solutions. Designed for finance professionals implementing ASC 842 accounting standards.");
  app.save(record0);

  const record1 = new Record(collection);
    record1.set("title", "Financial Analysis and Decision-Making - Case Study Workbook");
    record1.set("lesson_id", "pbc_3963162141_lesson_2");
    record1.set("part_number", 2);
    record1.set("case_study_name", "RetailCorp Inc");
    record1.set("company_background", "Large retail company with $500M annual revenue evaluating $15M equipment lease vs buy decision. Challenge: Conduct comprehensive financial analysis comparing lease and buy options using NPV, IRR, sensitivity analysis, and scenario analysis to support strategic decision-making.");
    record1.set("workbook_sections", "1. Company Background and Equipment Needs\n2. Lease and Buy Option Overview\n3. Cash Flow Identification Worksheet\n4. Lease Option Cash Flow Analysis (5-year projection)\n5. Buy Option Cash Flow Analysis (5-year projection)\n6. NPV Calculation Worksheet (lease option)\n7. NPV Calculation Worksheet (buy option)\n8. IRR Calculation Worksheet (lease option)\n9. IRR Calculation Worksheet (buy option)\n10. Sensitivity Analysis Template (5 key variables: discount rate, residual value, maintenance costs, tax rate, equipment cost)\n11. Scenario Analysis Worksheet (best case, base case, worst case)\n12. Break-Even Analysis Exercise\n13. Financial Metrics Comparison (payback period, profitability index, ROI)\n14. Practical Exercise 1: Calculate NPV and IRR for lease option (detailed step-by-step with formulas)\n15. Practical Exercise 2: Perform sensitivity analysis on discount rate and residual value\n16. Practical Exercise 3: Compare lease vs buy options and make recommendation with supporting analysis\n17. Discussion Questions (8 questions covering financial analysis methods, decision criteria, risk assessment, and strategic considerations)\n18. Solutions and Detailed Calculations with Excel formulas and interpretations");
    record1.set("includes_worksheets", true);
    record1.set("includes_templates", true);
    record1.set("includes_solutions", true);
    record1.set("content_summary", "Comprehensive financial analysis case study workbook. Includes detailed worksheets for NPV and IRR calculations, sensitivity and scenario analysis, break-even analysis, and financial metrics comparison. Practical exercises guide users through complete lease vs buy decision analysis with solutions.");
  app.save(record1);

  const record2 = new Record(collection);
    record2.set("title", "Financial Statement Management and Reporting - Case Study Workbook");
    record2.set("lesson_id", "pbc_3963162141_lesson_3");
    record2.set("part_number", 3);
    record2.set("case_study_name", "FinancialServices Corp");
    record2.set("company_background", "Financial services company with $300M annual revenue managing and reporting $50M lease portfolio impact on financial statements. Challenge: Properly present ROU assets and lease liabilities on balance sheet, calculate lease expense components, analyze financial ratio impacts, and prepare comprehensive lease disclosures.");
    record2.set("workbook_sections", "1. Company Background and Lease Portfolio Overview\n2. Current Financial Statements (balance sheet, income statement, cash flow statement)\n3. Lease Portfolio Summary (composition, terms, values, classification breakdown)\n4. Balance Sheet Impact Analysis Worksheet\n5. ROU Asset and Lease Liability Presentation Template\n6. Income Statement Impact Calculation Worksheet\n7. Lease Expense Breakdown (interest expense, depreciation expense, principal reduction)\n8. Cash Flow Statement Presentation Worksheet\n9. Financial Ratio Analysis Template (5 key ratios)\n10. Debt-to-Equity Ratio Impact Calculation\n11. Interest Coverage Ratio Impact Calculation\n12. Return on Assets (ROA) Impact Calculation\n13. Return on Equity (ROE) Impact Calculation\n14. Lease Disclosure Worksheet (footnote preparation per ASC 842)\n15. Practical Exercise 1: Prepare adjusted balance sheet with ROU assets and liabilities\n16. Practical Exercise 2: Calculate lease expense components and prepare income statement impact\n17. Practical Exercise 3: Analyze financial ratio impacts and prepare investor communication\n18. Discussion Questions (8 questions covering financial statement presentation, ratio analysis, disclosure requirements, and stakeholder communication)\n19. Solutions and Detailed Analysis with financial statement examples and ratio calculations");
    record2.set("includes_worksheets", true);
    record2.set("includes_templates", true);
    record2.set("includes_solutions", true);
    record2.set("content_summary", "Comprehensive financial statement management case study workbook. Includes detailed worksheets for balance sheet and income statement impact analysis, financial ratio calculations, lease expense breakdowns, and disclosure preparation. Practical exercises guide users through complete financial statement presentation and analysis.");
  app.save(record2);

  const record3 = new Record(collection);
    record3.set("title", "Tax Planning and Optimization - Case Study Workbook");
    record3.set("lesson_id", "pbc_3963162141_lesson_4");
    record3.set("part_number", 4);
    record3.set("case_study_name", "ManufacturingCorp Ltd");
    record3.set("company_background", "Manufacturing company with $200M annual revenue structuring $30M lease portfolio for maximum tax efficiency. Challenge: Analyze tax implications of operating vs finance leases, calculate tax deductions, evaluate tax optimization strategies, and manage deferred tax assets/liabilities.");
    record3.set("workbook_sections", "1. Company Background and Tax Position\n2. Current Lease Portfolio Overview\n3. Tax Assessment Worksheet\n4. Operating Lease Tax Benefits Analysis (5 leases with deduction calculations)\n5. Finance Lease Tax Considerations Analysis (5 leases with deduction calculations)\n6. Lease Payment Deduction Calculation Worksheet\n7. Depreciation Deduction Calculation Worksheet\n8. Interest Deduction Calculation Worksheet\n9. Tax Savings Calculation Template\n10. Tax Optimization Strategies Evaluation (5 strategies: lease structuring, timing, residual value, payment terms, equipment selection)\n11. Tax vs Accounting Treatment Worksheet (reconciliation of differences)\n12. Deferred Tax Asset/Liability Calculation\n13. Tax Provision Calculation Worksheet\n14. International Tax Considerations (if applicable)\n15. Practical Exercise 1: Calculate tax deductions for operating lease ($10M, 5-year term)\n16. Practical Exercise 2: Calculate tax deductions for finance lease ($8M, 4-year term)\n17. Practical Exercise 3: Evaluate tax optimization strategies and quantify tax savings\n18. Discussion Questions (8 questions covering tax deductions, optimization strategies, deferred taxes, and compliance)\n19. Solutions and Detailed Tax Analysis with calculations and strategy recommendations");
    record3.set("includes_worksheets", true);
    record3.set("includes_templates", true);
    record3.set("includes_solutions", true);
    record3.set("content_summary", "Comprehensive tax planning case study workbook. Includes detailed worksheets for tax deduction calculations, tax optimization strategy evaluation, deferred tax analysis, and tax provision calculations. Practical exercises guide users through tax analysis for both operating and finance leases with solutions.");
  app.save(record3);

  const record4 = new Record(collection);
    record4.set("title", "Practical Implementation and Best Practices - Case Study Workbook");
    record4.set("lesson_id", "pbc_3963162141_lesson_5");
    record4.set("part_number", 5);
    record4.set("case_study_name", "GlobalCorp International");
    record4.set("company_background", "Multinational corporation with $1B annual revenue implementing comprehensive lease portfolio management system for $200M portfolio containing 1,500+ leases. Challenge: Design and implement lease portfolio management system with proper controls, tracking mechanisms, compliance monitoring, and software evaluation.");
    record4.set("workbook_sections", "1. Company Background and Implementation Objectives\n2. Current Lease Portfolio Overview (1,500+ leases, geographic distribution, asset types)\n3. Lease Portfolio Management Assessment\n4. Lease Data Organization Worksheet\n5. Lease Register Template (sample entries with all required fields)\n6. Lease Tracking System Design Worksheet\n7. Lease Compliance Monitoring Checklist\n8. Portfolio Performance Metrics Calculation (WALT, WAC, WAL, yield)\n9. Internal Controls Framework Worksheet\n10. Approval Process Design Template\n11. Authorization Matrix Template\n12. Documentation Requirements Checklist\n13. Segregation of Duties Matrix\n14. Lease Accounting Software Evaluation Worksheet (5 software options with comparison criteria)\n15. Implementation Timeline Template (phased approach)\n16. Change Management Plan Worksheet\n17. Practical Exercise 1: Design lease portfolio management system for 1,500 leases\n18. Practical Exercise 2: Develop internal controls and approval processes\n19. Practical Exercise 3: Evaluate lease accounting software and create implementation plan\n20. Discussion Questions (8 questions covering system design, controls, compliance, software selection, and change management)\n21. Solutions and Detailed Recommendations with implementation examples and best practices");
    record4.set("includes_worksheets", true);
    record4.set("includes_templates", true);
    record4.set("includes_solutions", true);
    record4.set("content_summary", "Comprehensive implementation and best practices case study workbook. Includes detailed worksheets for lease portfolio management system design, internal controls framework, compliance monitoring, and software evaluation. Practical exercises guide users through complete implementation planning with solutions and best practices.");
  app.save(record4);
}, (app) => {
  // Rollback: record IDs not known, manual cleanup needed
})
