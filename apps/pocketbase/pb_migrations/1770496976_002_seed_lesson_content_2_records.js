/// <reference path="../pb_data/types.d.ts" />
migrate((app) => {
  const collection = app.findCollectionByNameOrId("lesson_content");

  const record0 = new Record(collection);
    record0.set("lesson_id", "lesson_3_1");
    record0.set("content_body", "# ROI Modeling and Forecasting\n\n## ROI Modeling Framework\n\n**What is ROI Modeling:**\n- Quantitative representation of ROI drivers\n- Projects future ROI based on assumptions\n- Identifies key value drivers\n- Supports decision-making\n- Example: Model showing ROI impact of 10% payment increase\n\n**Model Components:**\n\n1. **Input Assumptions:**\n   - Equipment cost, Lease payment, Lease term\n   - Residual value, Operating costs\n   - Cost of capital, Default rate\n   - Example: $100K equipment, $1,500/month payment\n\n2. **Calculations:**\n   - Revenue calculation, Cost calculation\n   - Profit calculation, ROI calculation\n   - Example: Revenue $90K, Costs $30K, Profit $60K, ROI 60%\n\n3. **Outputs:**\n   - ROI percentage, Absolute profit\n   - Cash flow projections, Sensitivity analysis\n   - Example: 12% ROI, $12K profit, positive cash flow\n\n4. **Sensitivity Analysis:**\n   - Impact of changing assumptions\n   - Identifies key drivers\n   - Assesses risk\n   - Example: 1% payment change = 0.5% ROI change\n\n## ROI Modeling Process (5 Steps)\n\n**Step 1 - Define Scope (1 week):**\nIdentify lease characteristics, Define analysis period, Determine key assumptions\n\n**Step 2 - Build Base Case (2 weeks):**\nCreate spreadsheet model, Input base case assumptions, Calculate base case ROI, Validate calculations\n\n**Step 3 - Develop Scenarios (1 week):**\nCreate upside scenario, Create downside scenario, Calculate ROI for each\n\n**Step 4 - Sensitivity Analysis (1 week):**\nIdentify key drivers, Test impact of changes, Create sensitivity tables\n\n**Step 5 - Analyze Results (1 week):**\nCompare scenarios, Assess risk, Identify key drivers, Make recommendations\n\n## ROI Model Examples\n\n**Example 1 - Simple Lessor Model:**\n- Equipment: $100K, Payment: $1,500/month, Term: 60 months\n- Residual: $20K, Maintenance: $3K/year, Insurance: $1K/year\n- Cost of capital: 6%\n- Revenue: ($1,500 \u00d7 60) + $20K = $110K\n- Costs: $100K + ($3K \u00d7 5) + ($1K \u00d7 5) = $120K\n- Profit: -$10K, ROI: -10%\n- Assessment: Negative ROI, unprofitable\n\n**Example 2 - Lessee ROI Model:**\n- Payment: $1,500/month, Term: 60 months\n- Productivity: $3,000/month, Maintenance savings: $200/month\n- Tax rate: 30%\n- Lease cost: $90K, Revenue: $180K, Savings: $12K\n- Tax benefit: $27K, Total benefits: $219K\n- Profit: $129K, ROI: 143%\n- Assessment: Excellent ROI\n\n## Scenario Analysis\n\n**Base Case:**\n- Equipment: $100K, Payment: $1,500, Residual: 20%, Default: 1%\n- ROI: 10%\n\n**Upside:**\n- Payment: $1,600 (+6.7%), Residual: 25% (+25%), Default: 0.5% (-50%)\n- ROI: 14%\n\n**Downside:**\n- Payment: $1,400 (-6.7%), Residual: 15% (-25%), Default: 2% (+100%)\n- ROI: 6%\n\n**Comparison:**\n- Upside: 14%, Base: 10%, Downside: 6%\n- Range: 8 percentage points\n- Risk Assessment: Upside 25%, Base 50%, Downside 25%, Expected ROI 10%\n\n## Case Study: ModelCorp ROI Modeling\n\n**Lease Details:**\n- Equipment: $500K, Payment: $8,500/month, Term: 60 months\n- Residual: 25%, Maintenance: $300/month, Insurance: $100/month\n- Cost of capital: 5%, Default: 1%\n\n**Base Case:**\n- Revenue: ($8,500 \u00d7 60) + $125K = $635K\n- Costs: $500K + $18K + $6K + $25K + $6.35K = $555.35K\n- Profit: $79.65K, ROI: 15.93%\n\n**Upside:**\n- Payment: $8,800, Residual: 28%, Default: 0.5%\n- Revenue: $668K, Costs: $545K, Profit: $123K, ROI: 24.6%\n\n**Downside:**\n- Payment: $8,200, Residual: 22%, Default: 1.5%\n- Revenue: $602K, Costs: $565K, Profit: $37K, ROI: 7.4%\n\n**Sensitivity Analysis:**\n- Payment \u00b11% = ROI \u00b10.8%\n- Residual \u00b11% = ROI \u00b10.3%\n- Default \u00b11% = ROI \u00b10.6%\n- Maintenance \u00b11% = ROI \u00b10.2%\n\n**Key Drivers:**\n1. Lease payment (0.8%)\n2. Default rate (0.6%)\n3. Residual value (0.3%)\n4. Maintenance (0.2%)\n\n**Recommendation:**\nBase case ROI 15.93% attractive, Upside to 24.6%, Downside to 7.4%, Focus on managing default and optimizing payment, Proceed with lease");
  app.save(record0);

  const record1 = new Record(collection);
    record1.set("lesson_id", "lesson_3_2");
    record1.set("content_body", "# Real-World ROI Applications and Best Practices\n\n## Real-World ROI Applications\n\n**Application 1 - Lease Pricing:**\n- Determine optimal payment\n- Balance profitability and competitiveness\n- Maximize ROI\n- Process: Calculate cost, Estimate residual, Determine target ROI, Calculate required payment, Compare to market\n- Example: Equipment $100K, Financing $6K, Residual $20K, Target ROI 12%, Required profit $12K, Required revenue $118K, Required payments $98K, Monthly $1,633\n\n**Application 2 - Credit Decision:**\n- Determine if lease profitable\n- Assess credit risk\n- Set terms based on risk\n- Process: Assess creditworthiness, Estimate default probability, Calculate expected loss, Adjust ROI for risk, Determine if acceptable\n- Example: Base ROI 12%, Default 2%, Expected loss $2K, Risk-adjusted ROI 10%\n\n**Application 3 - Portfolio Management:**\n- Optimize portfolio mix\n- Balance risk and return\n- Maximize portfolio ROI\n- Process: Calculate ROI for each lease, Identify high/low ROI, Adjust mix, Rebalance\n- Example: High ROI 15% (30%), Standard 10% (60%), Low 5% (10%), Portfolio ROI 10.5%\n\n**Application 4 - Equipment Selection:**\n- Determine which equipment to lease\n- Maximize residual value\n- Minimize obsolescence risk\n- Process: Analyze characteristics, Estimate residual, Assess obsolescence, Calculate ROI impact, Select best\n- Example: Equipment A 30% residual 5-year 12% ROI, Equipment B 20% residual 3-year 10% ROI, Equipment C 25% residual 4-year 11% ROI, Select A\n\n## Best Practices in ROI Analysis\n\n**Best Practice 1 - Conservative Assumptions:**\n- Underestimate revenue\n- Overestimate costs\n- Conservative residual\n- Higher default rate\n- Benefit: Reduces risk of overestimating ROI\n\n**Best Practice 2 - Sensitivity Analysis:**\n- Test key assumptions\n- Identify critical drivers\n- Assess downside risk\n- Benefit: Better understanding of risk\n\n**Best Practice 3 - Multiple Scenarios:**\n- Base case, upside, downside\n- Probability-weighted expected value\n- Stress testing\n- Benefit: Better risk assessment\n\n**Best Practice 4 - Benchmark Against Industry:**\n- Compare to industry averages\n- Identify outliers\n- Assess competitiveness\n- Benefit: Ensures competitive pricing\n\n**Best Practice 5 - Monitor Actual vs. Projected:**\n- Track actual ROI\n- Compare to projections\n- Identify variances\n- Adjust models\n- Benefit: Improves model accuracy\n\n**Best Practice 6 - Document Assumptions:**\n- Clear documentation\n- Rationale for each\n- Sources of data\n- Benefit: Transparency and auditability\n\n**Best Practice 7 - Regular Model Updates:**\n- Update with new data\n- Refine assumptions\n- Improve accuracy\n- Benefit: Better decision-making\n\n## Case Study: RealWorldCorp Implementation\n\n**Challenge:**\n- Inconsistent ROI calculations\n- Lack of standardized approach\n- Difficulty comparing leases\n- Suboptimal pricing\n\n**Solution:**\n- Develop standardized ROI model\n- Train staff\n- Implement ROI-based pricing\n- Monitor and optimize\n\n**Phase 1 - Model Development (Month 1-2):**\nBuild standardized model, Define assumptions, Test with historical leases, Refine\n\n**Phase 2 - Staff Training (Month 3):**\nTrain sales on ROI analysis, Train credit on ROI assessment, Train finance on monitoring, Develop materials\n\n**Phase 3 - Implementation (Month 4-6):**\nImplement ROI-based pricing, Use ROI in credit decisions, Monitor portfolio ROI, Adjust\n\n**Phase 4 - Optimization (Month 7+):**\nAnalyze results, Identify improvements, Optimize portfolio mix, Continuous improvement\n\n**Results:**\n- Before: Average ROI 9%, Range 5%-15%, Inconsistent pricing, Suboptimal mix\n- After: Average ROI 11%, Range 8%-14%, Consistent pricing, Optimized mix\n- Impact: 2% ROI improvement, $10M additional annual profit on $500M portfolio, Better risk management, Improved competitiveness");
  app.save(record1);
}, (app) => {
  // Rollback: record IDs not known, manual cleanup needed
})
